@model SIREON.Reservacione
@using Microsoft.AspNet.Identity
@{

}
<!DOCTYPE html>
<html lang="en">
<head>

</head>
<body>
    <div class="row">
        <div class="col-lg-12 equel-grid">
            <div class="grid">
                <p class="grid-header" style="border-left-color:green">Detalles de reservación</p>
                <div class="grid-body">
                    <div class="item-wrapper">
                        <form>
                            <div class="form-row align-items-center justify-content-between">

                                @{
                                    var FechayHora = DateTime.Now;
                                    var SelFecha = FechayHora.ToString("dd/MM/yyyy");
                                }
                                <div class="col-lg-2 col-md-2 col-sm-2  showcase_content_area">
                                    <label>Fecha:</label>
                                    <input type="text" class="form-control" id="fecha" placeholder="AAAA/MM/DD" value="@SelFecha" required>

                                </div>
                                <div class="col-lg-2 col-md-2 col-sm-2 showcase_text_area">
                                    <label>Hora de entrada:</label>
                                    <input type="time" class="form-control" id="Horaentrada" min="08:00" max="20:30" step="900" placeholder="HH:MM" value="" required>
                                    @*<select class="custom-select my-1 mr-sm-2" id="Horaentrada" required>
                                        <option value="" disabled selected>Elige...</option>
                                        <option value="08:00:00">08:00 AM</option>
                                        <option value="08:30:00">08:30 AM</option>
                                        <option value="09:00:00">09:00 AM</option>
                                        <option value="09:30:00">09:30 AM</option>
                                        <option value="10:00:00">10:00 AM</option>
                                        <option value="10:30:00">10:30 AM</option>
                                        <option value="11:00:00">11:00 AM</option>
                                        <option value="11:30:00">11:30 AM</option>
                                        <option value="12:00:00">12:00 PM</option>
                                        <option value="12:30:00">12:30 PM</option>
                                        <option value="13:00:00">01:00 PM</option>
                                        <option value="13:30:00">01:30 PM</option>
                                        <option value="14:00:00">02:00 PM</option>
                                        <option value="14:30:00">02:30 PM</option>
                                        <option value="15:00:00">03:00 PM</option>
                                        <option value="15:30:00">03:30 PM</option>
                                        <option value="16:00:00">04:00 PM</option>
                                        <option value="16:30:00">04:30 PM</option>
                                        <option value="17:00:00">05:00 PM</option>
                                        <option value="17:30:00">05:30 PM</option>
                                        <option value="18:00:00">06:00 PM</option>
                                        <option value="18:30:00">06:30 PM</option>
                                        <option value="19:00:00">07:00 PM</option>
                                        <option value="19:30:00">07:30 PM</option>
                                        <option value="20:00:00">08:00 PM</option>
                                        <option value="20:30:00">08:30 PM</option>
                                    </select>*@
                                </div>

                                <div class="col-lg-2 col-md-2 col-sm-2 showcase_text_area">
                                    <label>Hora de salida:</label>
                                    <input type="time" class="form-control" id="Horasalida" placeholder="HH:MM" value="" required>

                                </div>
                                <br />
                                <label>Disponibilidad:</label>
                                <img src="~/Content/images/check.png" alt="check" width="70" />
                                <img src="~/Content/images/warning.png" alt="check" width="70" />
                            </div>

                            <br />
                            <div class="row" style="justify-content:space-between">
                                <a href='@Url.Action("Index", "Reservaciones")' button type="button" class="btn btn-sm btn-primary" style="background-color:darkred">Regresar</a>
                                <button type="submit" class="btn btn-sm btn-primary" style="background-color:green">Consultar Disponibilidad</button>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-12 equel-grid">
            <div class="grid">
                <p class="grid-header" style="border-left-color:green">Integrantes</p>
                <div class="grid-body">
                    <div class="item-wrapper">
                        <form>
                            <h4>Responsable</h4>
                            <br />
                            <div class="form-row align-items-center justify-content-between">
                                <div class="col-lg-5 col-md-5 col-sm-5 my-1">
                                    <label class="sr-only" for="inlineFormInputName">Name</label>
                                    <input type="text" class="form-control" id="inlineFormInputName" placeholder="Gabriela Marte" value="Gabriela Marte" readonly>
                                </div>
                                <div class="col-lg-5 col-md-5 col-sm-5 my-1">
                                    <label class="sr-only" for="inlineFormInputGroupUsername">Usuario</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <img src="~/Content/images/at.png" alt="check" width="33" />
                                        </div>
                                        <input type="text" class="form-control" id="IdAspNetUsers" placeholder="gm20-0469" value="">

                                    </div>
                                </div>
                                <div class="col-auto my-1">
                                    <button class="btn btn-primary" id="ConsResponsable">Consultar</button>
                                </div>
                            </div>
                            <br />
                            <br />
                            <br />
                            <hr />
                            <h4>Integrantes</h4>
                            <br />
                            <div id="integrantes">
                                <!--Invitado-->
                                <div class="form-row align-items-center justify-content-between">
                                    <div class="col-lg-3 col-md-3 col-sm-3 my-1">
                                        <select class="custom-select my-1 mr-sm-2" id="TipoInvitado" runat="server" ClientIDMode="Static" required>
                                            <option value="Estudiante/Profesor" selected id="TipoInvitado2">Estudiante/Profesor</option>
                                            <option value="Invitado"id="TipoInvitado3">Invitado</option>
                                        </select>
                                        @*<input type="radio" id="Estudiante/Profesor" value="Estudiante/Profesor" name="TipoInvitado"/>
                                        <input type="radio" id="Invitado" value="Invitado" name="TipoInvitado"/>*@
                                    </div>
                                    <!--NombreEstudiante/Profesor-->
                                    <div class="col-lg-3 col-md-3 col-sm-3 my-1" style="display:block" id="NombreDeEstudiante">
                                        <label class="sr-only" for="inlineFormInputName">Name</label>
                                        <input type="text" class="form-control" id="NombreInvitado" placeholder="Gabriela Marte" value="Darwin Ferreyra">
                                    </div>
                                    <!-- Fin NombreEstudiante/Profesor-->

                                    <!--UsuarioEstudiante/Profesor-->
                                    <div class="col-lg-3 col-md-3 col-sm-3 my-1" style="display:block" id="UsuarioDeEstudiante">
                                        <label class="sr-only" for="inlineFormInputGroupUsername">Usuario</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <img src="~/Content/images/at.png" alt="check" width="33" />
                                            </div>
                                            <input type="text" class="form-control" id="UsuarioInvitado" placeholder="gm20-0469" value="357a2e31-49b2-488b-82d3-9e029b243bd5">
                                        </div>
                                    </div>
                                    <!--Fin UsuarioEstudiante/Profesor-->

                                    <!--NombreInvitado-->
                                    <div class="col-lg-3 col-md-3 col-sm-3 my-1" style="display:none" id="NombreDeInvitado">
                                        <label class="sr-only" for="inlineFormInputName">Name</label>
                                        <input type="text" class="form-control" id="NombreInvitado2" placeholder="Gabriela Marte" value="Darwin Ferreyra">
                                    </div>
                                    <!--Fin NombreInvitado-->

                                    <!--CedulaInvitado-->
                                    <div class="col-lg-3 col-md-3 col-sm-3 my-1" style="display:none" id="CedulaDeInvitado">
                                        <label class="sr-only" for="inlineFormInputGroupUsername">Usuario</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="CedulaInvitado" placeholder="001-2345678-9" value="">
                                        </div>
                                    </div>
                                    <!--Fin CedulaInvitado-->

                                    <div class="col-auto my-1">
                                        <button class="btn btn-primary" id="addToList">Agregar</button>
                                    </div>
                                </div>
                                <!--Fin de invitado-->
                            </div>

                        </form>
                        <br />
                        <br />
                        <table id="detailsTable" class="table">
                            <thead>
                                <tr>
                                    <th style="width:20%">Tipo</th>
                                    <th style="width:40%">Nombre</th>
                                    <th style="width:30%">Matricula</th>
                                    <th style="width:20%"></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        <br />
                        <br />
                        <div class="col-auto my-1">
                            <button class="btn btn-primary" id="saveOrder">Reservar</button>
                        </div>

                    </div>
                </div>

            </div>
        </div>

    </div>
    <br />

    <script>
        //Show Modal.
        function addNewOrder() {
            $("#newOrderModal").modal();
        }

        //Add Multiple Order.
        $("#addToList").click(function (e) {
            e.preventDefault();

            if ($.trim($("#TipoInvitado").val()) == "" || $.trim($("#NombreInvitado").val()) == "" || $.trim($("#UsuarioInvitado").val()) == "") return;

            var TipoInvitado = $("#TipoInvitado").val(),
                NombreInvitado = $("#NombreInvitado").val(),
                IdAspNetUser = $("#UsuarioInvitado").val(),
                detailsTableBody = $("#detailsTable tbody");

            var productItem = '<tr><td>' + TipoInvitado + '</td><td>' + NombreInvitado + '</td><td>' + IdAspNetUser + '</td><td>' + '</td><td><a data-itemId="0" href="#" class="deleteItem">Eliminar</a></td></tr>';
            detailsTableBody.append(productItem);
            clearItem();

        });
        //After Add A New Order In The List, Clear Clean The Form For Add More Order.
        function clearItem() {
            $("#NombreInvitado").val('');
            $("#UsuarioInvitado").val('');
        }
        // After Add A New Order In The List, If You Want, You Can Remove It.
        $(document).on('click', 'a.deleteItem', function (e) {
            e.preventDefault();
            var $self = $(this);
            if ($(this).attr('data-itemId') == "0") {
                $(this).parents('tr').css("background-color", "#ff6347").fadeOut(800, function () {
                    $(this).remove();
                });
            }
        });


        console.log



        //After Click Save Button Pass All Data View To Controller For Save Database
        function saveOrder(data) {

            return $.ajax({
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                type: 'POST',
                url: "/Reservaciones/SaveOrder2",
                data: data,
                success: function (result) {
                    alert(result);
                    location.reload();
                },
                error: function () {
                    alert("Error!")
                }
            });
        }


        ////Collect Multiple Order List For Pass To Controller
        $("#saveOrder").click(function (e) {
            e.preventDefault();

            //alert($("#fecha").val());


            var orderArr = [];
            orderArr.length = 0;

            $.each($("#detailsTable tbody tr"), function () {
                orderArr.push({
                    IdAspNetUser: $(this).find('td:eq(2)').html(),
                    IdReservacion: $().val()
                });
            });


            var data = JSON.stringify({
                HSolicitada: $("#Horaentrada").val(),
                HEntrada: $("#Horaentrada").val(),
                HSalida: $("#Horasalida").val(),
                IdAspNetUsers: $("#IdAspNetUsers").val(),
                reservaciones_Usuarios: orderArr
            });

            console.log(data);

            $.when(saveOrder(data)).then(function (response) {
                console.log(response);
            }).fail(function (err) {
                console.log(err);
            });
        });


        $(document).ready(
            $("#TipoInvitado").change(function () {
                var selectedValue = $(this).val();
                if (selectedValue == "Invitado") {
                    $("#UsuarioDeEstudiante").hide(0);
                    $("#NombreDeEstudiante").hide(0);
                    $("#NombreDeInvitado").show(0);
                    $("#CedulaDeInvitado").show(0);
                }
                else {
                    $("#UsuarioDeEstudiante").show(0);
                    $("#NombreDeEstudiante").show(0);
                    $("#NombreDeInvitado").hide(0);
                    $("#CedulaDeInvitado").hide(0);
                }
            })
        );
        

    </script>






















    @*<script>
            function AgregarIntegrate() {

                $('#integrantes').append('<div><div class="form-row align-items-center justify-content-between" ><div class="col-lg-3 col-md-3 col-sm-3 my-1"><select class="custom-select my-1 mr-sm-2" id="Invitado1"><option value="1" selected>Estudiante/Profesor</option><option value="2">Invitado</option></select></div><div class="col-lg-3 col-md-3 col-sm-3 my-1"><label class="sr-only" for="inlineFormInputName">Name</label><input type="text" class="form-control" id="inlineFormInputName" placeholder="Gabriela Marte" readonly></div><div class="col-lg-3 col-md-3 col-sm-3 my-1"><label class="sr-only" for="inlineFormInputGroupUsername">Usuario</label><div class="input-group"><div class="input-group-prepend"><img src="~/Content/images/at.png" alt="Matricula" width="33" /></div><input type="text" class="form-control" placeholder="gm20-0469" id="Usuario"></div></div><div class="col-auto my-1"><button onclick="Consultar()" class="btn btn-primary" id="btnConsultar">Consultar</button><button onclick="EliminarIntegrate()" class="btn btn-primary"  style="background-color:darkred" id="btn2">Eliminar</button></div></div></div>');

            }


            function EliminarIntegrante() {
                $('#integrantes').prepend();
                //$(this).children("#integrantes").remove();
            }

            function Fecha() {

                $('#fecha').get(Date);
            }

            function Consultar() {
                var data = { Usuario: $('#Usuario').val(), Reservacion: $('#Reservacion').val() };
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    data: "{data:" + JSON.stringify(data) + "}",
                    url: "/Reservaciones/SetRes",
                    success: function (data) {
                        //codigo de exito
                        alert("Disponible");
                    },
                    error: function (error) {
                        //codigo error
                        alert("No disponible");
                    }
                })

            }
        </script>*@


</body>
</html>

